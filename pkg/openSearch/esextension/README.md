<!-- gomarkdoc:embed:start -->

<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# esextensions

```go
import "github.com/greenbone/opensight-golang-libraries/pkg/openSearch/esextension"
```

Package esextensions provides extensions for https://github.com/aquasecurity/esquery

## Index

- [type CompositeAgg](<#CompositeAgg>)
  - [func Composite\(name string\) \*CompositeAgg](<#Composite>)
  - [func \(agg \*CompositeAgg\) After\(after map\[string\]string\) \*CompositeAgg](<#CompositeAgg.After>)
  - [func \(agg \*CompositeAgg\) Aggregations\(aggregations ...esquery.Aggregation\) \*CompositeAgg](<#CompositeAgg.Aggregations>)
  - [func \(agg \*CompositeAgg\) Map\(\) map\[string\]interface\{\}](<#CompositeAgg.Map>)
  - [func \(agg \*CompositeAgg\) Name\(\) string](<#CompositeAgg.Name>)
  - [func \(agg \*CompositeAgg\) Size\(size uint64\) \*CompositeAgg](<#CompositeAgg.Size>)
  - [func \(agg \*CompositeAgg\) Sources\(sources ...esquery.Mappable\) \*CompositeAgg](<#CompositeAgg.Sources>)
- [type MatchQuery](<#MatchQuery>)
  - [func Match\(field string, value interface\{\}\) \*MatchQuery](<#Match>)
  - [func \(mq \*MatchQuery\) Map\(\) map\[string\]interface\{\}](<#MatchQuery.Map>)
- [type NestedQuery](<#NestedQuery>)
  - [func Nested\(field string, q esquery.BoolQuery\) \*NestedQuery](<#Nested>)
  - [func \(nq \*NestedQuery\) Map\(\) map\[string\]interface\{\}](<#NestedQuery.Map>)
- [type ScriptedSumAggregation](<#ScriptedSumAggregation>)
  - [func ScriptedSumAgg\(name string, script string\) \*ScriptedSumAggregation](<#ScriptedSumAgg>)
  - [func \(a \*ScriptedSumAggregation\) Map\(\) map\[string\]interface\{\}](<#ScriptedSumAggregation.Map>)
  - [func \(a \*ScriptedSumAggregation\) Name\(\) string](<#ScriptedSumAggregation.Name>)
- [type TermsSource](<#TermsSource>)
  - [func Terms\(name string, field string\) \*TermsSource](<#Terms>)
  - [func \(t \*TermsSource\) Map\(\) map\[string\]interface\{\}](<#TermsSource.Map>)


<a name="CompositeAgg"></a>
## type [CompositeAgg](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/esextension/compositeAgg.go#L12-L18>)

CompositeAgg represents a composite aggregation, as described in https://www.elastic.co/guide/en/elasticsearch/reference/7.17/search-aggregations-bucket-composite-aggregation.html . To be used in conjunction with the esquery library https://github.com/aquasecurity/esquery

```go
type CompositeAgg struct {
    // contains filtered or unexported fields
}
```

<a name="Composite"></a>
### func [Composite](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/esextension/compositeAgg.go#L21>)

```go
func Composite(name string) *CompositeAgg
```

Composite creates an aggregation of type "composite".

<a name="CompositeAgg.After"></a>
### func \(\*CompositeAgg\) [After](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/esextension/compositeAgg.go#L45>)

```go
func (agg *CompositeAgg) After(after map[string]string) *CompositeAgg
```

After sets the identification for the entry after which the next results should be returned.

<a name="CompositeAgg.Aggregations"></a>
### func \(\*CompositeAgg\) [Aggregations](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/esextension/compositeAgg.go#L51>)

```go
func (agg *CompositeAgg) Aggregations(aggregations ...esquery.Aggregation) *CompositeAgg
```

Aggregations sets the aggregations to be used for the buckets.

<a name="CompositeAgg.Map"></a>
### func \(\*CompositeAgg\) [Map](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/esextension/compositeAgg.go#L58>)

```go
func (agg *CompositeAgg) Map() map[string]interface{}
```

Map returns a map representation of the CompositeAgg, thus implementing the esquery.Mappable interface. Used for serialization to JSON.

<a name="CompositeAgg.Name"></a>
### func \(\*CompositeAgg\) [Name](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/esextension/compositeAgg.go#L28>)

```go
func (agg *CompositeAgg) Name() string
```

Name returns the name of the aggregation, needed for the esquery.Aggregation interface.

<a name="CompositeAgg.Size"></a>
### func \(\*CompositeAgg\) [Size](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/esextension/compositeAgg.go#L33>)

```go
func (agg *CompositeAgg) Size(size uint64) *CompositeAgg
```

Size sets the maximum number of buckets to return.

<a name="CompositeAgg.Sources"></a>
### func \(\*CompositeAgg\) [Sources](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/esextension/compositeAgg.go#L39>)

```go
func (agg *CompositeAgg) Sources(sources ...esquery.Mappable) *CompositeAgg
```

Sources sets the sources for the buckets.

<a name="MatchQuery"></a>
## type [MatchQuery](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/esextension/matchQuery.go#L5-L8>)

MatchQuery represents an OpenSearch match part in an OpenSearch query as described in https://www.elastic.co/guide/en/elasticsearch/reference/7.17/query-filter-context.html#query-filter-context-ex

```go
type MatchQuery struct {
    Field string
    Value interface{}
}
```

<a name="Match"></a>
### func [Match](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/esextension/matchQuery.go#L21>)

```go
func Match(field string, value interface{}) *MatchQuery
```

Match creates a new MatchQuery.

<a name="MatchQuery.Map"></a>
### func \(\*MatchQuery\) [Map](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/esextension/matchQuery.go#L12>)

```go
func (mq *MatchQuery) Map() map[string]interface{}
```

Map returns a map representation of the MatchQuery, thus implementing the esquery.Mappable interface. Used for serialization to JSON.

<a name="NestedQuery"></a>
## type [NestedQuery](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/esextension/nestedQuery.go#L10-L13>)

NestedQuery represents an OpenSearch nested query.

```go
type NestedQuery struct {
    Path  string            `json:"path"`
    Query esquery.BoolQuery `json:"query"`
}
```

<a name="Nested"></a>
### func [Nested](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/esextension/nestedQuery.go#L16>)

```go
func Nested(field string, q esquery.BoolQuery) *NestedQuery
```

Nested creates a new NestedQuery.

<a name="NestedQuery.Map"></a>
### func \(\*NestedQuery\) [Map](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/esextension/nestedQuery.go#L33>)

```go
func (nq *NestedQuery) Map() map[string]interface{}
```

Map returns a map representation of the NestedQuery, thus implementing the esquery.Mappable interface. Used for serialization to JSON.

<a name="ScriptedSumAggregation"></a>
## type [ScriptedSumAggregation](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/esextension/scriptedSumAgg.go#L9-L12>)

ScriptedSumAggregation represents an aggregation that calculates the sum using a scripted expression. See https://www.elastic.co/guide/en/elasticsearch/reference/7.17/search-aggregations-metrics-sum-aggregation.html#_script_14 . To be used in conjunction with the esquery library https://github.com/aquasecurity/esquery

```go
type ScriptedSumAggregation struct {
    // contains filtered or unexported fields
}
```

<a name="ScriptedSumAgg"></a>
### func [ScriptedSumAgg](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/esextension/scriptedSumAgg.go#L36>)

```go
func ScriptedSumAgg(name string, script string) *ScriptedSumAggregation
```

ScriptedSumAgg is a function that creates a new instance of ScriptedSumAggregation. It takes the name and script as parameters and returns a pointer to the ScriptedSumAggregation struct. Example usage:

```
a := ScriptedSumAgg("testName", "testScript")
```

<a name="ScriptedSumAggregation.Map"></a>
### func \(\*ScriptedSumAggregation\) [Map](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/esextension/scriptedSumAgg.go#L21>)

```go
func (a *ScriptedSumAggregation) Map() map[string]interface{}
```

Map returns a map representation of the ScriptedSumAggregation, thus implementing the esquery.Mappable interface. Used for serialization to JSON.

<a name="ScriptedSumAggregation.Name"></a>
### func \(\*ScriptedSumAggregation\) [Name](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/esextension/scriptedSumAgg.go#L15>)

```go
func (a *ScriptedSumAggregation) Name() string
```

Name returns the name of the ScriptedSumAggregation, needed for the esquery.Aggregation interface.

<a name="TermsSource"></a>
## type [TermsSource](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/esextension/termsSource.go#L10-L13>)

TermsSource represents a terms value source to composite aggregations, as described in https://www.elastic.co/guide/en/elasticsearch/reference/7.17/search-aggregations-bucket-composite-aggregation.html#_terms see also CompositeAgg

```go
type TermsSource struct {
    // contains filtered or unexported fields
}
```

<a name="Terms"></a>
### func [Terms](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/esextension/termsSource.go#L20>)

```go
func Terms(name string, field string) *TermsSource
```

Terms creates a new TermsSource. Is tested in compositeAgg\_test.go.

name: The name of the terms TermsSource. field: The name of the field referenced.

<a name="TermsSource.Map"></a>
### func \(\*TermsSource\) [Map](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/esextension/termsSource.go#L30>)

```go
func (t *TermsSource) Map() map[string]interface{}
```

Map returns a map representation of the TermsSource, thus implementing the esquery.Mappable interface. Used for serialization to JSON. Is tested in compositeAgg\_test.go.

Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)


<!-- gomarkdoc:embed:end -->

# License

Copyright (C) 2022-2023 [Greenbone AG][Greenbone AG]

Licensed under the [GNU General Public License v3.0 or later](../../../LICENSE).