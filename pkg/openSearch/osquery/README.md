# query Package Documentation

> Simplified version of package `openSearchQuery`

package osquery provides a query builder for OpenSearch.

Usage example:

```go
q := openSearchQuery.NewBoolQueryBuilder(&openSearchQuery.QuerySettings{ /* ... */ })

if err := q.AddFilterRequest(filterRequest); err != nil {
    return nil, err
}

request, err := esquery.Search().

Query(q.Build()).
MarshalJSON()

if err != nil {
    return nil, err
}

responseBody, err := v.openSearchClient.Search(openSearchModels.VulnerabilityIndexName, request)

if err != nil {
    return nil, err
}
```

---

<!-- gomarkdoc:embed:start -->

<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# osquery

```go
import "github.com/greenbone/opensight-golang-libraries/pkg/openSearch/osquery"
```

package osquery provides a query builder for OpenSearch.

## Index

- [func HandleCompareOperatorBeginsWith\(fieldName string, fieldValue any\) \(esquery.Mappable, error\)](<#HandleCompareOperatorBeginsWith>)
- [func HandleCompareOperatorBetweenDates\(fieldName string, fieldValue any\) \(esquery.Mappable, error\)](<#HandleCompareOperatorBetweenDates>)
- [func HandleCompareOperatorContains\(fieldName string, fieldValue any\) \(esquery.Mappable, error\)](<#HandleCompareOperatorContains>)
- [func HandleCompareOperatorExists\(fieldName string, \_ any\) \(esquery.Mappable, error\)](<#HandleCompareOperatorExists>)
- [func HandleCompareOperatorIsEqualTo\(fieldName string, fieldValue any\) \(esquery.Mappable, error\)](<#HandleCompareOperatorIsEqualTo>)
- [func HandleCompareOperatorIsGreaterThan\(fieldName string, fieldValue any\) \(esquery.Mappable, error\)](<#HandleCompareOperatorIsGreaterThan>)
- [func HandleCompareOperatorIsGreaterThanOrEqualTo\(fieldName string, fieldValue any\) \(esquery.Mappable, error\)](<#HandleCompareOperatorIsGreaterThanOrEqualTo>)
- [func HandleCompareOperatorIsLessThan\(fieldName string, fieldValue any\) \(esquery.Mappable, error\)](<#HandleCompareOperatorIsLessThan>)
- [func HandleCompareOperatorIsLessThanOrEqualTo\(fieldName string, fieldValue any\) \(esquery.Mappable, error\)](<#HandleCompareOperatorIsLessThanOrEqualTo>)
- [func HandleCompareOperatorTextContains\(fieldName string, fieldValue any\) \(esquery.Mappable, error\)](<#HandleCompareOperatorTextContains>)
- [type BoolQueryBuilder](<#BoolQueryBuilder>)
  - [func NewBoolQueryBuilder\(querySettings \*QuerySettings\) \*BoolQueryBuilder](<#NewBoolQueryBuilder>)
  - [func NewBoolQueryBuilderWith\(query \*esquery.BoolQuery, querySettings \*QuerySettings\) \*BoolQueryBuilder](<#NewBoolQueryBuilderWith>)
  - [func \(q \*BoolQueryBuilder\) AddFilterRequest\(request \*filter.Request\) error](<#BoolQueryBuilder.AddFilterRequest>)
  - [func \(q \*BoolQueryBuilder\) AddTermFilter\(fieldName string, value any\) error](<#BoolQueryBuilder.AddTermFilter>)
  - [func \(q \*BoolQueryBuilder\) AddTermsFilter\(fieldName string, values ...any\) error](<#BoolQueryBuilder.AddTermsFilter>)
  - [func \(q \*BoolQueryBuilder\) Build\(\) \*esquery.BoolQuery](<#BoolQueryBuilder.Build>)
- [type CompareOperator](<#CompareOperator>)
- [type CompareOperatorHandler](<#CompareOperatorHandler>)
- [type QuerySettings](<#QuerySettings>)


<a name="HandleCompareOperatorBeginsWith"></a>
## func [HandleCompareOperatorBeginsWith](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/osquery/compareHandler.go#L66>)

```go
func HandleCompareOperatorBeginsWith(fieldName string, fieldValue any) (esquery.Mappable, error)
```

HandleCompareOperatorBeginsWith handles begins with

<a name="HandleCompareOperatorBetweenDates"></a>
## func [HandleCompareOperatorBetweenDates](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/osquery/compareHandler.go#L169>)

```go
func HandleCompareOperatorBetweenDates(fieldName string, fieldValue any) (esquery.Mappable, error)
```

HandleCompareOperatorBetweenDates constructs an OpenSearch range query for a given date field. It accepts a field name and a field value, which must be a slice of exactly 2 elements, representing the start and end of range. Accepted slice types: \- \[\]time.Time, \- \[\]string of two RFC3339Nano\-formatted strings, \- \[\]any, containing any combination of time.Time and RFC3339Nano\-formatted string.

The generated range query is inclusive of both the lower and upper bounds. If a documentâ€™s timestamp is exactly equal to the start or end date, it will still match the query.

<a name="HandleCompareOperatorContains"></a>
## func [HandleCompareOperatorContains](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/osquery/compareHandler.go#L27>)

```go
func HandleCompareOperatorContains(fieldName string, fieldValue any) (esquery.Mappable, error)
```

HandleCompareOperatorContains handles contains. In the index mapping the given field must be a string of type \`keyword\`.

<a name="HandleCompareOperatorExists"></a>
## func [HandleCompareOperatorExists](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/osquery/compareHandler.go#L157>)

```go
func HandleCompareOperatorExists(fieldName string, _ any) (esquery.Mappable, error)
```



<a name="HandleCompareOperatorIsEqualTo"></a>
## func [HandleCompareOperatorIsEqualTo](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/osquery/compareHandler.go#L16>)

```go
func HandleCompareOperatorIsEqualTo(fieldName string, fieldValue any) (esquery.Mappable, error)
```

HandleCompareOperatorIsEqualTo handles is equal to

<a name="HandleCompareOperatorIsGreaterThan"></a>
## func [HandleCompareOperatorIsGreaterThan](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/osquery/compareHandler.go#L124>)

```go
func HandleCompareOperatorIsGreaterThan(fieldName string, fieldValue any) (esquery.Mappable, error)
```

HandleCompareOperatorIsGreaterThan handles is greater than

<a name="HandleCompareOperatorIsGreaterThanOrEqualTo"></a>
## func [HandleCompareOperatorIsGreaterThanOrEqualTo](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/osquery/compareHandler.go#L107>)

```go
func HandleCompareOperatorIsGreaterThanOrEqualTo(fieldName string, fieldValue any) (esquery.Mappable, error)
```

HandleCompareOperatorIsGreaterThanOrEqualTo handles is greater than or equal to

<a name="HandleCompareOperatorIsLessThan"></a>
## func [HandleCompareOperatorIsLessThan](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/osquery/compareHandler.go#L141>)

```go
func HandleCompareOperatorIsLessThan(fieldName string, fieldValue any) (esquery.Mappable, error)
```

HandleCompareOperatorIsLessThan handles is less than

<a name="HandleCompareOperatorIsLessThanOrEqualTo"></a>
## func [HandleCompareOperatorIsLessThanOrEqualTo](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/osquery/compareHandler.go#L90>)

```go
func HandleCompareOperatorIsLessThanOrEqualTo(fieldName string, fieldValue any) (esquery.Mappable, error)
```

HandleCompareOperatorIsLessThanOrEqualTo handles is less than or equal to

<a name="HandleCompareOperatorTextContains"></a>
## func [HandleCompareOperatorTextContains](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/osquery/compareHandler.go#L52>)

```go
func HandleCompareOperatorTextContains(fieldName string, fieldValue any) (esquery.Mappable, error)
```

HandleCompareOperatorTextContains performs a full text search on the given field. In the index mapping it must be a string of type \`text\`.

<a name="BoolQueryBuilder"></a>
## type [BoolQueryBuilder](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/osquery/boolQueryBuilder.go#L17-L23>)

BoolQueryBuilder is a builder for an OpenSearch bool query. Use NewBoolQueryBuilder or NewBoolQueryBuilderWith for proper initialization.

```go
type BoolQueryBuilder struct {
    Must    []esquery.Mappable
    MustNot []esquery.Mappable
    // contains filtered or unexported fields
}
```

<a name="NewBoolQueryBuilder"></a>
### func [NewBoolQueryBuilder](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/osquery/boolQueryBuilder.go#L48>)

```go
func NewBoolQueryBuilder(querySettings *QuerySettings) *BoolQueryBuilder
```

NewBoolQueryBuilder creates a new BoolQueryBuilder and returns it. It uses the default set of CompareOperator.

querySettings is used to configure the query builder.

<a name="NewBoolQueryBuilderWith"></a>
### func [NewBoolQueryBuilderWith](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/osquery/boolQueryBuilder.go#L56>)

```go
func NewBoolQueryBuilderWith(query *esquery.BoolQuery, querySettings *QuerySettings) *BoolQueryBuilder
```

NewBoolQueryBuilderWith creates a new BoolQueryBuilder and returns it. It uses the default set of CompareOperator.

query is the initial bool query to use. querySettings is used to configure the query builder.

<a name="BoolQueryBuilder.AddFilterRequest"></a>
### func \(\*BoolQueryBuilder\) [AddFilterRequest](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/osquery/boolQueryBuilder.go#L135>)

```go
func (q *BoolQueryBuilder) AddFilterRequest(request *filter.Request) error
```

AddFilterRequest adds a filter request to this query. The filter request is translated into a bool query.

<a name="BoolQueryBuilder.AddTermFilter"></a>
### func \(\*BoolQueryBuilder\) [AddTermFilter](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/osquery/boolQueryBuilder.go#L84>)

```go
func (q *BoolQueryBuilder) AddTermFilter(fieldName string, value any) error
```

AddTermFilter adds a term filter to this query.

value is the value to filter for.

<a name="BoolQueryBuilder.AddTermsFilter"></a>
### func \(\*BoolQueryBuilder\) [AddTermsFilter](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/osquery/boolQueryBuilder.go#L67>)

```go
func (q *BoolQueryBuilder) AddTermsFilter(fieldName string, values ...any) error
```

AddTermsFilter adds a terms filter to this query.

values is the list of values to filter for.

<a name="BoolQueryBuilder.Build"></a>
### func \(\*BoolQueryBuilder\) [Build](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/osquery/boolQueryBuilder.go#L244>)

```go
func (q *BoolQueryBuilder) Build() *esquery.BoolQuery
```

Build returns the built query.

<a name="CompareOperator"></a>
## type [CompareOperator](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/osquery/boolQueryBuilder.go#L38-L43>)

CompareOperator defines a mapping between a filter.CompareOperator and a function to generate an appropriate query condition in form of a CompareOperatorHandler.

```go
type CompareOperator struct {
    Operator filter.CompareOperator
    Handler  CompareOperatorHandler
    // MustCondition defines whether the condition should be added to the must (true) or must_not clause (false).
    MustCondition bool
}
```

<a name="CompareOperatorHandler"></a>
## type [CompareOperatorHandler](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/osquery/boolQueryBuilder.go#L28>)

CompareOperatorHandler is a function that generates an appropriate query condition for the given field.

```go
type CompareOperatorHandler func(fieldName string, fieldValue any) (esquery.Mappable, error)
```

<a name="QuerySettings"></a>
## type [QuerySettings](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/osquery/boolQueryBuilder.go#L32-L34>)

QuerySettings is used to configure the query builder.

```go
type QuerySettings struct {
    FilterFieldMapping map[string]string
}
```

Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)


<!-- gomarkdoc:embed:end -->

# License

Copyright (C) 2022-2023 [Greenbone AG][Greenbone AG]

Licensed under the [GNU General Public License v3.0 or later](../../../LICENSE).