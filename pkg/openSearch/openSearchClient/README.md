<!-- gomarkdoc:embed:start -->

<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# openSearchClient

```go
import "github.com/greenbone/opensight-golang-libraries/pkg/openSearch/openSearchClient"
```

Package openSearchClient provides functionality for interacting with OpenSearch.

Package openSearchClient provides a client for OpenSearch designed to allow easy mocking in tests.

Example Usage:

```
clientConfig, err := config.ReadOpensearchClientConfig()
if err != nil {
	return err
}

opensearchProjectClient, err := NewOpenSearchProjectClient(context.Background(), clientConfig)
if err != nil {
	return err
}

client := NewClient(opensearchProjectClient, 10, 1)

query := `{"query":{"bool":{"filter":[{"term":{"oid":{"value":"1.3.6.1.4.1.25623.1.0.117842"}}}]}}}`
responseBody, err := client.Search(indexName, []byte(query))
if err != nil {
	return err
}

searchResponse, err := UnmarshalSearchResponse[*Vulnerability](responseBody)
if err != nil {
	return err
}
```

For further usage examples see ./client\_test.go.

## Index

- [func InitializeJson\(timeFormats \[\]string\)](<#InitializeJson>)
- [func InjectAuthenticationIntoClient\(client \*opensearchapi.Client, config config.OpensearchClientConfig, tokenReceiver TokenReceiver\) error](<#InjectAuthenticationIntoClient>)
- [func NewOpenSearchProjectClient\(ctx context.Context, config config.OpensearchClientConfig, tokenReceiver TokenReceiver\) \(\*opensearchapi.Client, error\)](<#NewOpenSearchProjectClient>)
- [func SerializeDocumentsForBulkUpdate\[T any\]\(indexName string, documents \[\]T\) \(\[\]byte, error\)](<#SerializeDocumentsForBulkUpdate>)
- [func StartOpensearchTestContainer\(ctx context.Context\) \(testcontainers.Container, config.OpensearchClientConfig, error\)](<#StartOpensearchTestContainer>)
- [func Unmarshal\(data \[\]byte, v any\) error](<#Unmarshal>)
- [func UnmarshalWithoutValidation\(data \[\]byte, v any\) error](<#UnmarshalWithoutValidation>)
- [type Authenticator](<#Authenticator>)
  - [func \(a \*Authenticator\) Perform\(req \*http.Request\) \(\*http.Response, error\)](<#Authenticator.Perform>)
- [type Bucket](<#Bucket>)
  - [func \(bucket \*Bucket\) UnmarshalJSON\(bytes \[\]byte\) error](<#Bucket.UnmarshalJSON>)
- [type BulkResponse](<#BulkResponse>)
- [type Client](<#Client>)
  - [func NewClient\(openSearchProjectClient \*opensearchapi.Client, updateMaxRetries int, updateRetryDelay time.Duration\) \*Client](<#NewClient>)
  - [func \(c \*Client\) AsyncDeleteByQuery\(indexName string, requestBody \[\]byte\) error](<#Client.AsyncDeleteByQuery>)
  - [func \(c \*Client\) BulkUpdate\(indexName string, requestBody \[\]byte\) error](<#Client.BulkUpdate>)
  - [func \(c \*Client\) Close\(\)](<#Client.Close>)
  - [func \(c \*Client\) CompositeAggStream\(indexName string, requestBody \[\]byte, ctx context.Context\) \(io.Reader, error\)](<#Client.CompositeAggStream>)
  - [func \(c \*Client\) Count\(indexName string, requestBody \[\]byte\) \(count int64, err error\)](<#Client.Count>)
  - [func \(c \*Client\) DeleteByQuery\(indexName string, requestBody \[\]byte\) error](<#Client.DeleteByQuery>)
  - [func \(c \*Client\) Search\(indexName string, requestBody \[\]byte\) \(responseBody \[\]byte, err error\)](<#Client.Search>)
  - [func \(c \*Client\) SearchStream\(indexName string, requestBody \[\]byte, scrollTimeout time.Duration, ctx context.Context\) \(io.Reader, error\)](<#Client.SearchStream>)
  - [func \(c \*Client\) Update\(indexName string, requestBody \[\]byte\) \(responseBody \[\]byte, err error\)](<#Client.Update>)
- [type CountReq](<#CountReq>)
  - [func \(r CountReq\) GetRequest\(\) \(\*http.Request, error\)](<#CountReq.GetRequest>)
- [type CountResp](<#CountResp>)
  - [func \(r CountResp\) Inspect\(\) opensearchapi.Inspect](<#CountResp.Inspect>)
- [type CreatedResponse](<#CreatedResponse>)
- [type DocumentError](<#DocumentError>)
- [type DocumentErrorType](<#DocumentErrorType>)
- [type DynamicAggregation](<#DynamicAggregation>)
- [type DynamicAggregationHits](<#DynamicAggregationHits>)
- [type IndexError](<#IndexError>)
- [type IndexFunction](<#IndexFunction>)
  - [func NewIndexFunction\(openSearchProjectClient \*opensearchapi.Client\) \*IndexFunction](<#NewIndexFunction>)
  - [func \(i \*IndexFunction\) AliasExists\(aliasName string\) \(bool, error\)](<#IndexFunction.AliasExists>)
  - [func \(i \*IndexFunction\) CreateIndex\(indexName string, indexSchema \[\]byte\) error](<#IndexFunction.CreateIndex>)
  - [func \(i \*IndexFunction\) CreateOrPutAlias\(aliasName string, indexNames ...string\) error](<#IndexFunction.CreateOrPutAlias>)
  - [func \(i \*IndexFunction\) DeleteAliasFromIndex\(indexName string, aliasName string\) error](<#IndexFunction.DeleteAliasFromIndex>)
  - [func \(i \*IndexFunction\) DeleteIndex\(indexName string\) error](<#IndexFunction.DeleteIndex>)
  - [func \(i \*IndexFunction\) ForceMerge\(index string, maximumNumberOfSegments int\) error](<#IndexFunction.ForceMerge>)
  - [func \(i \*IndexFunction\) GetIndexSettings\(index string\) \(map\[string\]interface\{\}, error\)](<#IndexFunction.GetIndexSettings>)
  - [func \(i \*IndexFunction\) GetIndexes\(pattern string\) \(\[\]string, error\)](<#IndexFunction.GetIndexes>)
  - [func \(i \*IndexFunction\) GetIndexesForAlias\(aliasName string\) \(\[\]string, error\)](<#IndexFunction.GetIndexesForAlias>)
  - [func \(i \*IndexFunction\) IndexExists\(indexName string\) \(bool, error\)](<#IndexFunction.IndexExists>)
  - [func \(i \*IndexFunction\) IndexHasAlias\(indexNames \[\]string, aliasNames \[\]string\) \(bool, error\)](<#IndexFunction.IndexHasAlias>)
  - [func \(i \*IndexFunction\) RefreshIndex\(index string\) error](<#IndexFunction.RefreshIndex>)
  - [func \(i \*IndexFunction\) RemoveIndexesFromAlias\(indexesToRemove \[\]string, aliasName string\) error](<#IndexFunction.RemoveIndexesFromAlias>)
  - [func \(i \*IndexFunction\) SetIndexSettings\(index string, settingsBody io.Reader\) error](<#IndexFunction.SetIndexSettings>)
- [type KeepJsonAsString](<#KeepJsonAsString>)
  - [func \(k \*KeepJsonAsString\) UnmarshalJSON\(data \[\]byte\) error](<#KeepJsonAsString.UnmarshalJSON>)
- [type OpenSearchError](<#OpenSearchError>)
  - [func NewOpenSearchError\(message string\) \*OpenSearchError](<#NewOpenSearchError>)
  - [func \(o \*OpenSearchError\) Error\(\) string](<#OpenSearchError.Error>)
- [type OpenSearchErrorResponse](<#OpenSearchErrorResponse>)
- [type OpenSearchErrors](<#OpenSearchErrors>)
- [type OpenSearchResourceAlreadyExists](<#OpenSearchResourceAlreadyExists>)
  - [func NewOpenSearchResourceAlreadyExists\(message string\) \*OpenSearchResourceAlreadyExists](<#NewOpenSearchResourceAlreadyExists>)
  - [func \(o \*OpenSearchResourceAlreadyExists\) Error\(\) string](<#OpenSearchResourceAlreadyExists.Error>)
- [type OpenSearchResourceNotFound](<#OpenSearchResourceNotFound>)
  - [func NewOpenSearchResourceNotFound\(message string\) \*OpenSearchResourceNotFound](<#NewOpenSearchResourceNotFound>)
  - [func \(o \*OpenSearchResourceNotFound\) Error\(\) string](<#OpenSearchResourceNotFound.Error>)
- [type OpenSearchRootCause](<#OpenSearchRootCause>)
- [type OpensearchTestContainer](<#OpensearchTestContainer>)
- [type Request](<#Request>)
- [type Response](<#Response>)
- [type SearchResponse](<#SearchResponse>)
  - [func UnmarshalSearchResponse\[T any\]\(data \[\]byte\) \(\*SearchResponse\[T\], error\)](<#UnmarshalSearchResponse>)
  - [func \(s SearchResponse\[T\]\) GetResults\(\) \[\]T](<#SearchResponse[T].GetResults>)
  - [func \(s SearchResponse\[T\]\) GetSearchHits\(\) \[\]SearchResponseHit\[T\]](<#SearchResponse[T].GetSearchHits>)
- [type SearchResponseAggregation](<#SearchResponseAggregation>)
- [type SearchResponseAggregations](<#SearchResponseAggregations>)
- [type SearchResponseHit](<#SearchResponseHit>)
- [type SearchResponseHits](<#SearchResponseHits>)
- [type SearchResponseHitsTotal](<#SearchResponseHitsTotal>)
- [type ShardStats](<#ShardStats>)
- [type TokenReceiver](<#TokenReceiver>)
- [type UpdateQueue](<#UpdateQueue>)
  - [func NewRequestQueue\(openSearchClient \*opensearchapi.Client, updateMaxRetries int, updateRetryDelay time.Duration\) \*UpdateQueue](<#NewRequestQueue>)
  - [func \(q \*UpdateQueue\) Stop\(\)](<#UpdateQueue.Stop>)
  - [func \(q \*UpdateQueue\) Update\(indexName string, requestBody \[\]byte\) \(\[\]byte, error\)](<#UpdateQueue.Update>)


<a name="InitializeJson"></a>
## func [InitializeJson](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/json.go#L18>)

```go
func InitializeJson(timeFormats []string)
```



<a name="InjectAuthenticationIntoClient"></a>
## func [InjectAuthenticationIntoClient](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/authenticator.go#L49-L51>)

```go
func InjectAuthenticationIntoClient(client *opensearchapi.Client, config config.OpensearchClientConfig, tokenReceiver TokenReceiver) error
```

InjectAuthenticationIntoClient is a function that sets up the authentication method for the OpenSearch client. client is the OpenSearch client to inject the authentication into. config is the configuration for the OpenSearch client. tokenReceiver is the token receiver for OpenID authentication and must implement the GetClientAccessToken function. It can be nil for basic authentication.

<a name="NewOpenSearchProjectClient"></a>
## func [NewOpenSearchProjectClient](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/opensearchProjectClient.go#L26-L28>)

```go
func NewOpenSearchProjectClient(ctx context.Context, config config.OpensearchClientConfig, tokenReceiver TokenReceiver) (*opensearchapi.Client, error)
```

NewOpenSearchProjectClient creates a new official OpenSearch client \(package github.com/opensearch\-project/opensearch\-go\) for usage NewClient. It returns an error if the client couldn't be created or the connection couldn't be established.

ctx is the context to use for the connection. config is the configuration for the client.

<a name="SerializeDocumentsForBulkUpdate"></a>
## func [SerializeDocumentsForBulkUpdate](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/client.go#L426>)

```go
func SerializeDocumentsForBulkUpdate[T any](indexName string, documents []T) ([]byte, error)
```

SerializeDocumentsForBulkUpdate serializes documents for bulk update. Can be used in conjunction with BulkUpdate. It returns the serialized documents or an error in case something went wrong.

indexName is the name of the index to update. documents are the documents to update.

<a name="StartOpensearchTestContainer"></a>
## func [StartOpensearchTestContainer](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/opensearchTestContainer.go#L31>)

```go
func StartOpensearchTestContainer(ctx context.Context) (testcontainers.Container, config.OpensearchClientConfig, error)
```

StartOpensearchTestContainer starts a test container with opensearch and returns the container and the config for the opensearch client. It returns an error if the container couldn't be created or started.

ctx is the context to use for the container.

<a name="Unmarshal"></a>
## func [Unmarshal](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/json.go#L53>)

```go
func Unmarshal(data []byte, v any) error
```

Unmarshal unmarshalls data into v. It returns an error if the data is invalid.

<a name="UnmarshalWithoutValidation"></a>
## func [UnmarshalWithoutValidation](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/json.go#L80>)

```go
func UnmarshalWithoutValidation(data []byte, v any) error
```

UnmarshalWithoutValidation unmarshalls data into v. It returns an error if the data can not be parsed.

<a name="Authenticator"></a>
## type [Authenticator](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/authenticator.go#L35-L40>)

Authenticator is a struct that holds the necessary information for authenticating with OpenSearch.

```go
type Authenticator struct {
    // contains filtered or unexported fields
}
```

<a name="Authenticator.Perform"></a>
### func \(\*Authenticator\) [Perform](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/authenticator.go#L125>)

```go
func (a *Authenticator) Perform(req *http.Request) (*http.Response, error)
```

Perform is a method that implements the opensearchtransport.Interface interface. It injects the authentication header into the request and then performs the request.

<a name="Bucket"></a>
## type [Bucket](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/response.go#L49-L54>)



```go
type Bucket struct {
    Key         any    `json:"key"`
    KeyAsString string `json:"key_as_string"`
    DocCount    uint   `json:"doc_count"`
    Aggs        map[string]DynamicAggregation
}
```

<a name="Bucket.UnmarshalJSON"></a>
### func \(\*Bucket\) [UnmarshalJSON](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/response.go#L70>)

```go
func (bucket *Bucket) UnmarshalJSON(bytes []byte) error
```



<a name="BulkResponse"></a>
## type [BulkResponse](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/response.go#L128-L132>)

BulkResponse bulk response

```go
type BulkResponse struct {
    Took     uint         `json:"took"`
    HasError bool         `json:"errors"`
    Errors   []IndexError `json:"items"`
}
```

<a name="Client"></a>
## type [Client](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/client.go#L25-L28>)

Client is a client for OpenSearch designed to allow easy mocking in tests. It is a wrapper around the official OpenSearch client github.com/opensearch\-project/opensearch\-go .

```go
type Client struct {
    // contains filtered or unexported fields
}
```

<a name="NewClient"></a>
### func [NewClient](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/client.go#L35>)

```go
func NewClient(openSearchProjectClient *opensearchapi.Client, updateMaxRetries int, updateRetryDelay time.Duration) *Client
```

NewClient creates a new OpenSearch client.

openSearchProjectClient is the official OpenSearch client to wrap. Use NewOpenSearchProjectClient to create it. updateMaxRetries is the number of retries for update requests. updateRetryDelay is the delay between retries.

<a name="Client.AsyncDeleteByQuery"></a>
### func \(\*Client\) [AsyncDeleteByQuery](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/client.go#L387>)

```go
func (c *Client) AsyncDeleteByQuery(indexName string, requestBody []byte) error
```

AsyncDeleteByQuery updates documents in the given index asynchronously. It does not wait for the update to finish before returning. It returns an error in case something went wrong.

indexName is the name of the index to delete from. requestBody is the request body to send to OpenSearch to identify the documents to be deleted.

<a name="Client.BulkUpdate"></a>
### func \(\*Client\) [BulkUpdate](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/client.go#L451>)

```go
func (c *Client) BulkUpdate(indexName string, requestBody []byte) error
```

BulkUpdate performs a bulk update in the given index. It returns an error in case something went wrong.

indexName is the name of the index to update. requestBody is the request body to send to OpenSearch specifying the bulk update.

<a name="Client.Close"></a>
### func \(\*Client\) [Close](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/client.go#L470>)

```go
func (c *Client) Close()
```

Close stops the underlying UpdateQueue allowing a graceful shutdown.

<a name="Client.CompositeAggStream"></a>
### func \(\*Client\) [CompositeAggStream](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/client.go#L221>)

```go
func (c *Client) CompositeAggStream(indexName string, requestBody []byte, ctx context.Context) (io.Reader, error)
```



<a name="Client.Count"></a>
### func \(\*Client\) [Count](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/client.go#L78>)

```go
func (c *Client) Count(indexName string, requestBody []byte) (count int64, err error)
```



<a name="Client.DeleteByQuery"></a>
### func \(\*Client\) [DeleteByQuery](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/client.go#L397>)

```go
func (c *Client) DeleteByQuery(indexName string, requestBody []byte) error
```

DeleteByQuery updates documents in the given index. It waits for the update to finish before returning. It returns an error in case something went wrong.

indexName is the name of the index to delete from. requestBody is the request body to send to OpenSearch to identify the documents to be deleted.

<a name="Client.Search"></a>
### func \(\*Client\) [Search](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/client.go#L48>)

```go
func (c *Client) Search(indexName string, requestBody []byte) (responseBody []byte, err error)
```

Search searches for documents in the given index.

indexName is the name of the index to search in. requestBody is the request body to send to OpenSearch. It returns the response body as or an error in case something went wrong.

<a name="Client.SearchStream"></a>
### func \(\*Client\) [SearchStream](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/client.go#L108>)

```go
func (c *Client) SearchStream(indexName string, requestBody []byte, scrollTimeout time.Duration, ctx context.Context) (io.Reader, error)
```



<a name="Client.Update"></a>
### func \(\*Client\) [Update](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/client.go#L377>)

```go
func (c *Client) Update(indexName string, requestBody []byte) (responseBody []byte, err error)
```

Update updates documents in the given index using UpdateQueue \(which is also part of this package\). It does not wait for the update to finish before returning. It returns the response body as or an error in case something went wrong.

indexName is the name of the index to update. requestBody is the request body to send to OpenSearch specifying the update.

<a name="CountReq"></a>
## type [CountReq](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/count.go#L17-L22>)



```go
type CountReq struct {
    Indices []string
    Body    io.Reader
    Header  http.Header
    Params  map[string]string
}
```

<a name="CountReq.GetRequest"></a>
### func \(CountReq\) [GetRequest](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/count.go#L25>)

```go
func (r CountReq) GetRequest() (*http.Request, error)
```

GetRequest returns the \*http.Request that gets executed by the client

<a name="CountResp"></a>
## type [CountResp](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/count.go#L45-L48>)



```go
type CountResp struct {
    Count  int64      `json:"count"`
    Shards ShardStats `json:"_shards"`
}
```

<a name="CountResp.Inspect"></a>
### func \(CountResp\) [Inspect](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/count.go#L57>)

```go
func (r CountResp) Inspect() opensearchapi.Inspect
```



<a name="CreatedResponse"></a>
## type [CreatedResponse](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/response.go#L122-L125>)



```go
type CreatedResponse struct {
    Id     string `json:"_id"`
    Result string `json:"result"`
}
```

<a name="DocumentError"></a>
## type [DocumentError](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/error.go#L71-L77>)



```go
type DocumentError struct {
    IndexName  string            `json:"_index"`
    IndexType  string            `json:"_type"`
    DocumentId string            `json:"_id"`
    StatusCode uint              `json:"status"`
    Error      DocumentErrorType `json:"error"`
}
```

<a name="DocumentErrorType"></a>
## type [DocumentErrorType](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/error.go#L79-L82>)



```go
type DocumentErrorType struct {
    Type   string `json:"type"`
    Reason string `json:"reason"`
}
```

<a name="DynamicAggregation"></a>
## type [DynamicAggregation](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/response.go#L84-L91>)



```go
type DynamicAggregation struct {
    DocCountErrorUpperBound int                    `json:"doc_count_error_upper_bound"`
    SumOtherDocCount        uint                   `json:"sum_other_doc_count"`
    Buckets                 []Bucket               `json:"buckets"`
    Value                   any                    `json:"value"`
    ValueAsString           any                    `json:"value_as_string"`
    Hits                    DynamicAggregationHits `json:"hits"`
}
```

<a name="DynamicAggregationHits"></a>
## type [DynamicAggregationHits](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/response.go#L30-L33>)



```go
type DynamicAggregationHits struct {
    Total      SearchResponseHitsTotal `json:"total"`
    SearchHits KeepJsonAsString        `json:"hits"`
}
```

<a name="IndexError"></a>
## type [IndexError](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/error.go#L68-L70>)



```go
type IndexError struct {
    Index DocumentError `json:"index"`
}
```

<a name="IndexFunction"></a>
## type [IndexFunction](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/indexFunctions.go#L21-L23>)



```go
type IndexFunction struct {
    // contains filtered or unexported fields
}
```

<a name="NewIndexFunction"></a>
### func [NewIndexFunction](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/indexFunctions.go#L25>)

```go
func NewIndexFunction(openSearchProjectClient *opensearchapi.Client) *IndexFunction
```



<a name="IndexFunction.AliasExists"></a>
### func \(\*IndexFunction\) [AliasExists](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/indexFunctions.go#L178>)

```go
func (i *IndexFunction) AliasExists(aliasName string) (bool, error)
```



<a name="IndexFunction.CreateIndex"></a>
### func \(\*IndexFunction\) [CreateIndex](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/indexFunctions.go#L30>)

```go
func (i *IndexFunction) CreateIndex(indexName string, indexSchema []byte) error
```

CreateIndex creates an index

<a name="IndexFunction.CreateOrPutAlias"></a>
### func \(\*IndexFunction\) [CreateOrPutAlias](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/indexFunctions.go#L127>)

```go
func (i *IndexFunction) CreateOrPutAlias(aliasName string, indexNames ...string) error
```



<a name="IndexFunction.DeleteAliasFromIndex"></a>
### func \(\*IndexFunction\) [DeleteAliasFromIndex](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/indexFunctions.go#L143>)

```go
func (i *IndexFunction) DeleteAliasFromIndex(indexName string, aliasName string) error
```



<a name="IndexFunction.DeleteIndex"></a>
### func \(\*IndexFunction\) [DeleteIndex](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/indexFunctions.go#L113>)

```go
func (i *IndexFunction) DeleteIndex(indexName string) error
```



<a name="IndexFunction.ForceMerge"></a>
### func \(\*IndexFunction\) [ForceMerge](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/indexFunctions.go#L335>)

```go
func (i *IndexFunction) ForceMerge(index string, maximumNumberOfSegments int) error
```



<a name="IndexFunction.GetIndexSettings"></a>
### func \(\*IndexFunction\) [GetIndexSettings](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/indexFunctions.go#L288>)

```go
func (i *IndexFunction) GetIndexSettings(index string) (map[string]interface{}, error)
```



<a name="IndexFunction.GetIndexes"></a>
### func \(\*IndexFunction\) [GetIndexes](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/indexFunctions.go#L48>)

```go
func (i *IndexFunction) GetIndexes(pattern string) ([]string, error)
```



<a name="IndexFunction.GetIndexesForAlias"></a>
### func \(\*IndexFunction\) [GetIndexesForAlias](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/indexFunctions.go#L201>)

```go
func (i *IndexFunction) GetIndexesForAlias(aliasName string) ([]string, error)
```

previously AliasPointsToIndex

<a name="IndexFunction.IndexExists"></a>
### func \(\*IndexFunction\) [IndexExists](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/indexFunctions.go#L89>)

```go
func (i *IndexFunction) IndexExists(indexName string) (bool, error)
```



<a name="IndexFunction.IndexHasAlias"></a>
### func \(\*IndexFunction\) [IndexHasAlias](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/indexFunctions.go#L158>)

```go
func (i *IndexFunction) IndexHasAlias(indexNames []string, aliasNames []string) (bool, error)
```



<a name="IndexFunction.RefreshIndex"></a>
### func \(\*IndexFunction\) [RefreshIndex](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/indexFunctions.go#L271>)

```go
func (i *IndexFunction) RefreshIndex(index string) error
```



<a name="IndexFunction.RemoveIndexesFromAlias"></a>
### func \(\*IndexFunction\) [RemoveIndexesFromAlias](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/indexFunctions.go#L220>)

```go
func (i *IndexFunction) RemoveIndexesFromAlias(indexesToRemove []string, aliasName string) error
```



<a name="IndexFunction.SetIndexSettings"></a>
### func \(\*IndexFunction\) [SetIndexSettings](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/indexFunctions.go#L316>)

```go
func (i *IndexFunction) SetIndexSettings(index string, settingsBody io.Reader) error
```



<a name="KeepJsonAsString"></a>
## type [KeepJsonAsString](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/response.go#L22>)



```go
type KeepJsonAsString []byte
```

<a name="KeepJsonAsString.UnmarshalJSON"></a>
### func \(\*KeepJsonAsString\) [UnmarshalJSON](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/response.go#L24>)

```go
func (k *KeepJsonAsString) UnmarshalJSON(data []byte) error
```



<a name="OpenSearchError"></a>
## type [OpenSearchError](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/error.go#L24-L26>)

OpenSearchError openSearch error

```go
type OpenSearchError struct {
    Message string
}
```

<a name="NewOpenSearchError"></a>
### func [NewOpenSearchError](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/error.go#L32>)

```go
func NewOpenSearchError(message string) *OpenSearchError
```



<a name="OpenSearchError.Error"></a>
### func \(\*OpenSearchError\) [Error](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/error.go#L28>)

```go
func (o *OpenSearchError) Error() string
```



<a name="OpenSearchErrorResponse"></a>
## type [OpenSearchErrorResponse](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/error.go#L18-L21>)



```go
type OpenSearchErrorResponse struct {
    Error  OpenSearchErrors
    Status int
}
```

<a name="OpenSearchErrors"></a>
## type [OpenSearchErrors](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/error.go#L7-L11>)



```go
type OpenSearchErrors struct {
    Reasons []OpenSearchRootCause
    Type    string
    Reason  string
}
```

<a name="OpenSearchResourceAlreadyExists"></a>
## type [OpenSearchResourceAlreadyExists](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/error.go#L39-L41>)

OpenSearchResourceAlreadyExists openSearch resource already exists

```go
type OpenSearchResourceAlreadyExists struct {
    Message string
}
```

<a name="NewOpenSearchResourceAlreadyExists"></a>
### func [NewOpenSearchResourceAlreadyExists](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/error.go#L47>)

```go
func NewOpenSearchResourceAlreadyExists(message string) *OpenSearchResourceAlreadyExists
```



<a name="OpenSearchResourceAlreadyExists.Error"></a>
### func \(\*OpenSearchResourceAlreadyExists\) [Error](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/error.go#L43>)

```go
func (o *OpenSearchResourceAlreadyExists) Error() string
```



<a name="OpenSearchResourceNotFound"></a>
## type [OpenSearchResourceNotFound](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/error.go#L54-L56>)

OpenSearchResourceNotFound openSearch resource already exists

```go
type OpenSearchResourceNotFound struct {
    Message string
}
```

<a name="NewOpenSearchResourceNotFound"></a>
### func [NewOpenSearchResourceNotFound](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/error.go#L62>)

```go
func NewOpenSearchResourceNotFound(message string) *OpenSearchResourceNotFound
```



<a name="OpenSearchResourceNotFound.Error"></a>
### func \(\*OpenSearchResourceNotFound\) [Error](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/error.go#L58>)

```go
func (o *OpenSearchResourceNotFound) Error() string
```



<a name="OpenSearchRootCause"></a>
## type [OpenSearchRootCause](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/error.go#L13-L16>)



```go
type OpenSearchRootCause struct {
    Type   string
    Reason string
}
```

<a name="OpensearchTestContainer"></a>
## type [OpensearchTestContainer](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/opensearchTestContainer.go#L20-L22>)

OpensearchTestContainer represents the opensearch container

```go
type OpensearchTestContainer struct {
    testcontainers.Container
}
```

<a name="Request"></a>
## type [Request](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/updateQueue.go#L25-L29>)



```go
type Request struct {
    IndexName   string
    RequestBody []byte
    Response    chan Response // Use the new Response type
}
```

<a name="Response"></a>
## type [Response](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/updateQueue.go#L20-L23>)



```go
type Response struct {
    Body []byte
    Err  error
}
```

<a name="SearchResponse"></a>
## type [SearchResponse](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/response.go#L102-L107>)



```go
type SearchResponse[T any] struct {
    Took         uint                       `json:"took"`
    TimedOut     bool                       `json:"timed_out"`
    Hits         SearchResponseHits[T]      `json:"hits"`
    Aggregations SearchResponseAggregations `json:"aggregations"`
}
```

<a name="UnmarshalSearchResponse"></a>
### func [UnmarshalSearchResponse](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/response.go#L35>)

```go
func UnmarshalSearchResponse[T any](data []byte) (*SearchResponse[T], error)
```



<a name="SearchResponse[T].GetResults"></a>
### func \(SearchResponse\[T\]\) [GetResults](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/response.go#L114>)

```go
func (s SearchResponse[T]) GetResults() []T
```

GetResults returns list of documents

<a name="SearchResponse[T].GetSearchHits"></a>
### func \(SearchResponse\[T\]\) [GetSearchHits](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/response.go#L109>)

```go
func (s SearchResponse[T]) GetSearchHits() []SearchResponseHit[T]
```



<a name="SearchResponseAggregation"></a>
## type [SearchResponseAggregation](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/response.go#L93-L98>)



```go
type SearchResponseAggregation struct {
    DocCountErrorUpperBound int      `json:"doc_count_error_upper_bound"`
    SumOtherDocCount        uint     `json:"sum_other_doc_count"`
    Buckets                 []Bucket `json:"buckets"`
    Value                   uint64   `json:"value"`
}
```

<a name="SearchResponseAggregations"></a>
## type [SearchResponseAggregations](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/response.go#L100>)



```go
type SearchResponseAggregations map[string]SearchResponseAggregation
```

<a name="SearchResponseHit"></a>
## type [SearchResponseHit](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/response.go#L11-L15>)



```go
type SearchResponseHit[T any] struct {
    Id      string `json:"_id"`
    Type    string `json:"_type"`
    Content T      `json:"_source"`
}
```

<a name="SearchResponseHits"></a>
## type [SearchResponseHits](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/response.go#L17-L20>)



```go
type SearchResponseHits[T any] struct {
    Total      SearchResponseHitsTotal
    SearchHits []SearchResponseHit[T] `json:"hits"`
}
```

<a name="SearchResponseHitsTotal"></a>
## type [SearchResponseHitsTotal](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/response.go#L44-L47>)



```go
type SearchResponseHitsTotal struct {
    Value    uint
    Relation string
}
```

<a name="ShardStats"></a>
## type [ShardStats](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/count.go#L50-L55>)



```go
type ShardStats struct {
    Total      int `json:"total"`
    Successful int `json:"successful"`
    Skipped    int `json:"skipped"`
    Failed     int `json:"failed"`
}
```

<a name="TokenReceiver"></a>
## type [TokenReceiver](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/authenticator.go#L29-L32>)

TokenReceiver is an interface for receiving client access tokens.

```go
type TokenReceiver interface {
    GetClientAccessToken(clientName, clientSecret string) (string, error)
    ClearClientAccessToken()
}
```

<a name="UpdateQueue"></a>
## type [UpdateQueue](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/updateQueue.go#L32-L39>)

UpdateQueue is a queue for OpenSearch update requests.

```go
type UpdateQueue struct {
    // contains filtered or unexported fields
}
```

<a name="NewRequestQueue"></a>
### func [NewRequestQueue](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/updateQueue.go#L46>)

```go
func NewRequestQueue(openSearchClient *opensearchapi.Client, updateMaxRetries int, updateRetryDelay time.Duration) *UpdateQueue
```

NewRequestQueue creates a new update queue.

openSearchClient is the official OpenSearch client. Use NewOpenSearchProjectClient to create it. updateMaxRetries is the number of retries for update requests. updateRetryDelay is the delay between retries.

<a name="UpdateQueue.Stop"></a>
### func \(\*UpdateQueue\) [Stop](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/updateQueue.go#L63>)

```go
func (q *UpdateQueue) Stop()
```



<a name="UpdateQueue.Update"></a>
### func \(\*UpdateQueue\) [Update](<https://github.com/greenbone/opensight-golang-libraries/blob/main/pkg/openSearch/openSearchClient/updateQueue.go#L78>)

```go
func (q *UpdateQueue) Update(indexName string, requestBody []byte) ([]byte, error)
```

Update queues and update for an index and returns the response body or an error

Is called from pkg/openSearch/open\_search\_client/client.go: func \(c \*Client\) Update\(indexName string, requestBody \[\]byte\) \(responseBody \[\]byte, err error\) and tested in pkg/openSearch/open\_search\_client/client\_test.go

indexName: The name of the index to update requestBody: The request body to send to the index

Returns: The response body or an error

Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)


<!-- gomarkdoc:embed:end -->

# License

Copyright (C) 2022-2023 [Greenbone AG][Greenbone AG]

Licensed under the [GNU General Public License v3.0 or later](../../../LICENSE).
